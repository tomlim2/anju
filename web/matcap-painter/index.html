<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matcap Painter</title>
<link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32.png">
<link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
<meta name="description" content="Paint matcap textures in the browser with layers, blend modes, and real-time 3D preview. 228 built-in matcap presets.">
<meta property="og:title" content="Matcap Painter">
<meta property="og:description" content="Browser-based matcap texture editor with real-time 3D preview">
<meta property="og:type" content="website">
<script type="importmap">
{
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.172.0/build/three.core.js",
    "three/webgpu": "https://cdn.jsdelivr.net/npm/three@0.172.0/build/three.webgpu.js",
    "three/tsl": "https://cdn.jsdelivr.net/npm/three@0.172.0/build/three.tsl.js",
    "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.172.0/examples/jsm/"
  }
}
</script>
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #1a1a1a;
  --panel: #232323;
  --surface: #2a2a2a;
  --border: #2f2f2f;
  --text: #d4d4d4;
  --text-dim: #999;
  --text-muted: #8a8a8a;
  --accent: #5b9bd5;
  --accent-dim: #3d6d99;
  --btn: #2e2e2e;
  --btn-hover: #363636;
  --btn-active: #5b9bd5;
  --layer-hover: #2c2c2c;
  --layer-active: #2e3548;
  --track: #3a3a3a;
  --thumb: #888;
  --thumb-hover: #aaa;

  /* spacing & sizing tokens */
  --radius-sm: 3px;
  --radius-md: 4px;
  --radius-lg: 8px;
  --font-xs: 10px;
  --font-sm: 11px;

  /* z-index scale */
  --z-canvas-bg: 0;
  --z-canvas: 1;
  --z-canvas-mask: 2;
  --z-cursor: 3;
  --z-nav: 10;
  --z-controls: 10;
  --z-overlay: 1000;
}

html, body {
  height: 100%;
  background: var(--bg);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  font-size: 12px;
  overflow: hidden;
  user-select: none;
  -webkit-font-smoothing: antialiased;
}

/* --- Top Bar --- */
.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 36px;
  padding: 0 12px;
  background: var(--panel);
  border-bottom: 1px solid var(--border);
}
.topbar h1 {
  font-size: 12px;
  font-weight: 500;
  color: var(--text-dim);
  letter-spacing: 0.3px;
}
.topbar-version { font-weight: 400; color: var(--text-muted); font-size: var(--font-xs); }
.topbar-copy { color: var(--text-muted); font-size: var(--font-xs); letter-spacing: 0.2px; }

/* --- Main Layout --- */
.main {
  display: flex;
  height: calc(100% - 36px);
}

/* --- Left Panel --- */
.left-panel {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  border-right: 1px solid var(--border);
  background: var(--panel);
}

/* Toolbar */
.toolbar {
  padding: 6px 10px;
  display: flex;
  gap: 4px;
  align-items: center;
  border-bottom: 1px solid var(--border);
}
.toolbar-group {
  display: flex;
  gap: 1px;
  align-items: center;
}
.tool-btn {
  width: 28px;
  height: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-md);
  color: var(--text-dim);
  cursor: pointer;
  transition: background 0.12s, color 0.12s, border-color 0.12s;
}
.tool-btn:hover { background: var(--btn-hover); color: var(--text); }
.tool-btn.active {
  background: var(--accent);
  color: #fff;
  border-color: transparent;
}
.tool-btn svg { width: 15px; height: 15px; }

/* --- Slider Component --- */
.slider {
  display: flex;
  align-items: center;
  gap: 6px;
  height: 24px;
}
.slider-label {
  color: var(--text-muted);
  font-size: var(--font-xs);
  text-transform: uppercase;
  letter-spacing: 0.4px;
  min-width: 18px;
  flex-shrink: 0;
}
.slider-track {
  -webkit-appearance: none;
  appearance: none;
  width: 72px;
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  outline: none;
  cursor: pointer;
}
.slider-track::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
  transition: background 0.12s;
}
.slider-track::-webkit-slider-thumb:hover { background: var(--thumb-hover); }
.slider-track::-webkit-slider-thumb:active { background: var(--accent); }
.slider-track:focus-visible { outline: 2px solid var(--accent-dim); outline-offset: 2px; }
.slider-track::-moz-range-thumb {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
}
.slider-track::-moz-range-track {
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  border: none;
}
.slider-val {
  color: var(--text-dim);
  font-size: var(--font-xs);
  font-family: inherit;
  font-variant-numeric: tabular-nums;
  width: 30px;
  text-align: right;
  flex-shrink: 0;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  padding: 1px 2px;
  outline: none;
  -moz-appearance: textfield;
}
.slider-val::-webkit-inner-spin-button,
.slider-val::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
.slider-val:hover { border-color: var(--border); }
.slider-val:focus-visible { border-color: var(--accent-dim); color: var(--text); }

/* Controls row */
.controls-row {
  padding: 5px 10px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  border-bottom: 1px solid var(--border);
}
.control-color {
  display: flex;
  align-items: center;
  gap: 4px;
}
.control-color label {
  color: var(--text-muted);
  font-size: var(--font-xs);
  text-transform: uppercase;
  letter-spacing: 0.4px;
}
.control-color input[type="color"] {
  width: 24px;
  height: 20px;
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  background: none;
  cursor: pointer;
  padding: 0;
}
.control-color input[type="color"]::-webkit-color-swatch-wrapper { padding: 1px; }
.control-color input[type="color"]::-webkit-color-swatch { border-radius: 2px; border: none; }
.color-chips {
  display: flex;
  gap: 3px;
  align-items: center;
}
.color-chip {
  width: 16px;
  height: 16px;
  border-radius: var(--radius-sm);
  border: 1px solid rgba(255,255,255,0.12);
  cursor: pointer;
  padding: 0;
  box-sizing: border-box;
}
.color-chip:hover {
  border-color: rgba(255,255,255,0.5);
}
.controls-sep {
  width: 1px;
  height: 16px;
  background: var(--border);
}

/* Canvas area */
.canvas-area {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  position: relative;
  background: var(--bg);
}
.canvas-area.panning { cursor: grab; }
.canvas-area.panning:active { cursor: grabbing; }
.canvas-area.panning .paint-canvas { cursor: grab; }
.canvas-area.panning:active .paint-canvas { cursor: grabbing; }
.canvas-wrap {
  position: relative;
  will-change: transform;
  opacity: 0;
}
.canvas-wrap > * {
  display: block;
}
.canvas-nav {
  position: absolute;
  bottom: 8px;
  right: 8px;
  display: flex;
  gap: 2px;
  background: rgba(30,30,30,0.85);
  border-radius: 5px;
  padding: 3px;
  backdrop-filter: blur(4px);
  z-index: var(--z-nav);
}
.nav-btn {
  width: 26px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  color: var(--text-dim);
  cursor: pointer;
  transition: background 0.12s, color 0.12s;
}
.nav-btn:hover { background: var(--btn-hover); color: var(--text); }
.nav-btn.active { background: var(--accent); color: #fff; }
.nav-btn svg { width: 14px; height: 14px; }
.zoom-badge {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.6);
  color: var(--text-dim);
  font-size: var(--font-xs);
  padding: 2px 8px;
  border-radius: var(--radius-sm);
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
}
.zoom-badge.visible { opacity: 1; }
.paint-canvas {
  cursor: none;
  image-rendering: auto;
  position: relative;
  z-index: var(--z-canvas);
}
.canvas-bg {
  position: absolute;
  inset: 0;
  z-index: var(--z-canvas-bg);
  border-radius: 50%;
  background: repeating-conic-gradient(#2a2a2a 0% 25%, #222 0% 50%) 50% / 16px 16px;
  pointer-events: none;
}
.canvas-circle-mask {
  position: absolute;
  inset: 0;
  z-index: var(--z-canvas-mask);
  pointer-events: none;
  border-radius: 50%;
  border: 2px dashed rgba(0,0,0,0.3);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,0.2);
}
.cursor-overlay {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: var(--z-cursor);
}

/* Layers panel */
.layers-panel {
  flex: 1;
  min-height: 0;
  border-top: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  background: var(--panel);
}
.layers-body {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}
.layers-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 10px;
  border-bottom: 1px solid var(--border);
  font-size: var(--font-xs);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: var(--text-dim);
}
.layers-actions { display: flex; gap: 1px; }
.layers-actions button {
  width: 24px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: var(--radius-sm);
  color: var(--text-dim);
  cursor: pointer;
  transition: background 0.12s, color 0.12s;
}
.layers-actions button:hover { background: var(--btn-hover); color: var(--text); }
.layers-actions button svg { width: 14px; height: 14px; }
.layer-list {
  flex: 1;
  overflow-y: auto;
  padding: 2px;
}
.layer-item {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 3px 8px;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: var(--font-sm);
  transition: background 0.1s;
}
.layer-grip {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 10px;
  flex-shrink: 0;
  cursor: grab;
  color: var(--text-muted);
  opacity: 0;
  transition: opacity 0.12s;
}
.layer-grip:active { cursor: grabbing; }
.layer-item:hover .layer-grip { opacity: 1; }
.layer-item:hover { background: var(--layer-hover); }
.layer-item.active { background: var(--layer-active); }
.layer-item.dragging { opacity: 0.35; }
.layer-item.drag-over-top { box-shadow: 0 -2px 0 var(--accent); }
.layer-item.drag-over-bottom { box-shadow: 0 2px 0 var(--accent); }
.layer-name {
  flex: 1;
  color: var(--text);
  font-size: var(--font-sm);
}
.layer-solo {
  width: 14px;
  height: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 9px;
  font-weight: 600;
  color: var(--text-muted);
  border-radius: 2px;
  flex-shrink: 0;
  opacity: 0;
  transition: opacity 0.12s, color 0.12s, background 0.12s;
}
.layer-item:hover .layer-solo { opacity: 1; }
.layer-solo:hover { color: var(--text); background: var(--btn-hover); }
.layer-solo.active {
  opacity: 1;
  color: #fff;
  background: var(--accent);
}
.layer-vis {
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: var(--text-dim);
  transition: opacity 0.1s;
}
.layer-vis:hover { color: var(--text); }
.layer-vis.hidden { opacity: 0.25; }
.layer-thumb {
  width: 28px;
  height: 28px;
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
  flex-shrink: 0;
  image-rendering: auto;
  background: repeating-conic-gradient(#2a2a2a 0% 25%, #222 0% 50%) 50% / 6px 6px;
}
.layer-opacity {
  -webkit-appearance: none;
  appearance: none;
  width: 44px;
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  outline: none;
  cursor: pointer;
}
.layer-opacity:focus-visible { outline: 2px solid var(--accent-dim); outline-offset: 2px; }
.layer-opacity::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
}
.layer-opacity::-moz-range-thumb {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
}
.layer-opacity::-moz-range-track {
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  border: none;
}
.layer-blend {
  background: var(--surface);
  color: var(--text-dim);
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  padding: 1px 4px;
  font-size: var(--font-xs);
  outline: none;
  cursor: pointer;
  flex-shrink: 0;
}
.layer-blend:focus-visible { border-color: var(--accent-dim); }

/* Layer Detail Toggle (per-layer) */
.layer-detail-btn {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  cursor: pointer;
  flex-shrink: 0;
  padding: 0;
  transition: background 0.12s, color 0.12s;
}
.layer-detail-btn:hover { background: var(--btn-hover); color: var(--text); }
.layer-detail-btn.open { color: var(--accent); }
.layer-detail-btn svg { width: 14px; height: 14px; }

/* Layer Settings Panel (accordion inside layer list) */
.layer-settings {
  display: none;
  flex-direction: column;
  overflow-y: auto;
  flex-shrink: 0;
  background: rgba(255,255,255,0.03);
  margin: 0 4px 4px;
  border-radius: 0 0 4px 4px;
  border-left: 2px solid var(--accent-dim);
}
.layer-settings.open {
  display: flex;
}
.layer-settings-section {
  padding: 6px 10px;
  border-bottom: 1px solid var(--border);
}
.layer-settings-title {
  font-size: var(--font-xs);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: var(--text-muted);
  margin-bottom: 4px;
}
.detail-panel {
  display: flex;
  flex-direction: column;
  gap: 3px;
}
.hsv-row {
  display: flex;
  align-items: center;
  gap: 6px;
  height: 20px;
}
.hsv-label {
  color: var(--text-muted);
  font-size: var(--font-xs);
  font-weight: 500;
  min-width: 10px;
  flex-shrink: 0;
}
.hsv-slider {
  -webkit-appearance: none;
  appearance: none;
  flex: 1;
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  outline: none;
  cursor: pointer;
}
.hsv-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
  transition: background 0.12s;
}
.hsv-slider::-webkit-slider-thumb:hover { background: var(--thumb-hover); }
.hsv-slider::-webkit-slider-thumb:active { background: var(--accent); }
.hsv-slider:focus-visible { outline: 2px solid var(--accent-dim); outline-offset: 2px; }
.hsv-slider::-moz-range-thumb {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
}
.hsv-slider::-moz-range-track {
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  border: none;
}
.hsv-val {
  color: var(--text-dim);
  font-size: var(--font-xs);
  font-family: inherit;
  font-variant-numeric: tabular-nums;
  width: 34px;
  text-align: right;
  flex-shrink: 0;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  padding: 1px 2px;
  outline: none;
  -moz-appearance: textfield;
}
.hsv-val::-webkit-inner-spin-button,
.hsv-val::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
.hsv-val:hover { border-color: var(--border); }
.hsv-val:focus-visible { border-color: var(--accent-dim); color: var(--text); }

/* --- Right Panel (3D Preview + Layers) --- */
.right-panel {
  width: 480px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  background: #111;
}
.preview-area {
  width: 480px;
  height: 480px;
  position: relative;
  flex-shrink: 0;
}
.preview-canvas {
  width: 100%;
  height: 100%;
  display: block;
}
.vp-controls-left, .vp-controls-right {
  position: absolute;
  top: 8px;
  z-index: var(--z-controls);
  display: flex;
  gap: 4px;
  align-items: center;
}
.vp-controls-left { left: 8px; }
.vp-controls-right { right: 8px; }
.vp-btn {
  width: 26px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  color: var(--text-dim);
  cursor: pointer;
  font-size: 13px;
  line-height: 1;
  transition: background 0.12s, color 0.12s;
  backdrop-filter: blur(4px);
}
.vp-btn:hover { background: var(--btn-hover); color: var(--text); }
.vp-btn.active { background: var(--accent); color: #fff; }
.vp-controls-left select, .vp-controls-right select {
  background: rgba(30,30,30,0.85);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: var(--radius-md);
  padding: 4px 8px;
  font-size: var(--font-sm);
  cursor: pointer;
  outline: none;
  backdrop-filter: blur(4px);
}
.vp-controls-left select:focus-visible, .vp-controls-right select:focus-visible { border-color: var(--accent-dim); }

/* Scrollbar */
::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #3a3a3a; border-radius: var(--radius-sm); }
::-webkit-scrollbar-thumb:hover { background: #4a4a4a; }

/* Layer matcap button */
.layer-matcap-btn {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: var(--radius-sm);
  color: var(--text-muted);
  cursor: pointer;
  flex-shrink: 0;
  transition: background 0.12s, color 0.12s;
  padding: 0;
}
.layer-matcap-btn:hover { background: var(--btn-hover); color: var(--text); }

/* Matcap Picker Modal */
.matcap-picker-overlay {
  position: fixed;
  inset: 0;
  z-index: var(--z-overlay);
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s;
}
.matcap-picker-overlay.open {
  opacity: 1;
  pointer-events: auto;
}
.matcap-picker {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  width: 600px;
  max-width: 90vw;
  max-height: 70vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
  transform: scale(0.96);
  transition: transform 0.15s;
}
.matcap-picker-overlay.open .matcap-picker {
  transform: scale(1);
}
.matcap-picker-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}
.matcap-picker-title {
  font-size: var(--font-sm);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: var(--text-dim);
}
.matcap-picker-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(64px, 1fr));
  grid-auto-rows: 70px;
  gap: 24px 12px;
  padding: 10px 16px 32px;
  overflow-y: auto;
  flex: 1;
  min-height: 0;
}
.matcap-thumb {
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
  transition: transform 0.12s;
}
.matcap-thumb:hover {
  transform: scale(1.08);
}
.matcap-thumb img {
  width: 100%;
  aspect-ratio: 1;
  display: block;
  border-radius: 50%;
  object-fit: cover;
  border: 2px solid transparent;
  background: var(--surface);
  transition: border-color 0.12s;
}
.matcap-thumb:hover img {
  border-color: var(--accent);
}
.matcap-num {
  font-size: var(--font-sm);
  color: var(--text-dim);
  line-height: 1;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    transition-duration: 0.01ms !important;
    animation-duration: 0.01ms !important;
  }
}
</style>
</head>
<body>

<div class="topbar">
  <h1>Matcap Painter <span class="topbar-version">v1.0.0</span></h1>
  <span class="topbar-copy">&copy; 2026 tomlim2 &middot; Matcaps from <a href="https://github.com/nidorx/matcaps" target="_blank" rel="noopener" style="color:var(--text-dim)">nidorx/matcaps</a> (ISC)</span>
</div>

<div class="main">
  <div class="left-panel">
    <!-- Toolbar -->
    <div class="toolbar">
      <div class="toolbar-group">
        <button class="tool-btn active" data-tool="brush" title="Brush (B)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M247.69-147.69q-34.33 0-67.89-15.08-33.57-15.08-55.95-40.31 22.92-6.54 43.38-27.81 20.46-21.26 20.46-56.8 0-41.93 29.04-70.96 29.04-29.04 70.96-29.04 41.93 0 70.96 29.04 29.04 29.03 29.04 70.96 0 57.75-41.12 98.87-41.13 41.13-98.88 41.13Zm0-60q33 0 56.5-23.5t23.5-56.5q0-17-11.5-28.5t-28.5-11.5q-17 0-28.5 11.5t-11.5 28.5q0 23-5.5 42t-14.5 36q5 2 10 2h10ZM460-370l-89.23-89.23 342.61-342.61q11-11 27.5-11.5t28.5 11.5l33.23 33.23q12 12 12 28t-12 28L460-370Zm-172.31 82.31Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="airbrush" title="Airbrush (A)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M460-174.62q-43.08 0-74.04-29.03-30.96-29.04-34.42-70.96h60.77q3.07 17.38 16.31 28.69 13.23 11.31 31.38 11.31 20.85 0 35.42-14.58Q510-263.77 510-284.62q0-20.84-14.58-35.42-14.57-14.58-35.42-14.58H90v-59.99h370q45.77 0 77.88 32.11Q570-330.38 570-284.62q0 45.77-32.12 77.89-32.11 32.11-77.88 32.11ZM90-565.39v-59.99h530q29.85 0 49.92-20.08Q690-665.54 690-695.38q0-29.85-20.08-49.93-20.07-20.08-49.92-20.08-27.54 0-46.46 17-18.93 17-22 43h-60.77q3.46-51.3 40.31-85.65 36.84-34.34 88.92-34.34 54.77 0 92.38 37.61Q750-750.15 750-695.38q0 54.76-37.62 92.38-37.61 37.61-92.38 37.61H90Zm660 314.62v-60.77q26-3.07 43-22 17-18.92 17-46.46 0-29.85-20.08-49.92Q769.85-450 740-450H90v-60h650q54.77 0 92.38 37.62Q870-434.77 870-380q0 52.08-34.35 88.92-34.34 36.85-85.65 40.31Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="blur" title="Blur (R)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M426.38-533.62q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54Zm0 160q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54ZM294-546q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm106 286q8 0 14-6t6-14q0-8-6-14t-14-6q-8 0-14 6t-6 14q0 8 6 14t14 6ZM294-386q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm120-280q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm172.38 132.38q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54ZM574-666q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm120 280q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm0-160q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6ZM331.86-129.92q-69.37-29.92-120.68-81.21-51.31-51.29-81.25-120.63Q100-401.1 100-479.93q0-78.84 29.92-148.21t81.21-120.68q51.29-51.31 120.63-81.25Q401.1-860 479.93-860q78.84 0 148.21 29.92t120.68 81.21q51.31 51.29 81.25 120.63Q860-558.9 860-480.07q0 78.84-29.92 148.21t-81.21 120.68q-51.29 51.31-120.63 81.25Q558.9-100 480.07-100q-78.84 0-148.21-29.92ZM480-160q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm94-106q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm12.38-107.62q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54ZM480-480Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="eraser" title="Eraser (E)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M679.23-240h188.46v60H619.23l60-60Zm-493.08 60-70.76-70.77Q94.31-271.85 93.81-302t20.58-52.23l423.07-439.08q21.08-22.07 50.92-21.88 29.85.19 50.93 21.27l181.3 181.31q21.08 21.07 21.27 51.42.19 30.34-20.88 51.42L499.23-180H186.15Zm287.54-60 305.15-313.15q3.08-3.08 3.08-8.85t-3.08-8.85L598.15-751.54q-3.07-3.07-8.65-3.07t-8.66 3.46l-424.3 438.3q-3.08 3.46-3.08 9.04 0 5.58 3.08 8.66L211.69-240h262ZM480-480Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="fill" title="Fill (F)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M346.77-159.23 119.23-386.77q-9.61-9.66-14.42-21.25-4.81-11.6-4.81-24.1 0-12.5 4.81-24.03 4.81-11.54 14.42-21.16l226.16-225.54-110.62-109.07 46.61-48.46L664.5-476.89q9.58 9.58 14.08 21.14t4.5 24.09q0 12.52-4.5 24.08-4.5 11.56-14.12 21.2L437.31-159.23q-9.62 9.61-21.16 14.42-11.53 4.81-24.03 4.81-12.5 0-24.1-4.81-11.59-4.81-21.25-14.42Zm45.08-497.16L175.54-440.08q-2.31 2.31-3.08 4.62t-.77 4.61H612q0-2.3-.77-4.61-.77-2.31-3.08-4.62l-216.3-216.31ZM782.38-140q-32.15 0-54.07-22.6-21.93-22.61-21.93-55.4 0-24.31 11.39-46.39 11.38-22.07 27.23-42.38l37.38-47.08 39.39 47.08q15.23 20.31 26.92 42.38 11.69 22.08 11.69 46.39 0 32.79-22.92 55.4-22.92 22.6-55.08 22.6Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="eyedropper" title="Eyedropper (I)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M120-120v-190l358-358-58-56 58-56 76 76 124-124q5.25-5.25 12.13-8.12Q697-839 704.5-839t14.37 2.88q6.88 2.87 12.13 8.12l42 42q5.25 5.25 8.13 12.13Q784-767 784-759.5t-2.87 14.37q-2.88 6.88-8.13 12.13L649-609l76 76-56 58-56-58-358 358H120Zm80-80h36l284-284-36-36-284 284v36Z"/></svg>
        </button>
        <button class="tool-btn" id="tool-pan" title="Pan (H)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M419.31-70q-27.47 0-51.27-12.35-23.81-12.34-39.65-35.42l-250-366.08 16.3-15.69q15.93-15.92 37.7-17.96 21.76-2.04 39.69 10.65L300-417.77v-361.07q0-12.75 8.63-21.38 8.63-8.62 21.38-8.62 12.76 0 21.37 8.62 8.62 8.63 8.62 21.38v476.61L197.77-415.85l180.08 263.62q6.54 10.31 17.65 16.27 11.12 5.96 23.81 5.96H670q37.61 0 63.81-26.19Q760-182.39 760-220v-530q0-12.75 8.63-21.37 8.63-8.63 21.38-8.63 12.76 0 21.37 8.63Q820-762.75 820-750v530q0 62.15-43.92 106.07Q732.15-70 670-70H419.31Zm34.15-420v-368.84q0-12.75 8.63-21.38 8.63-8.62 21.39-8.62 12.75 0 21.37 8.62 8.61 8.63 8.61 21.38V-490h-60Zm153.46 0v-328.84q0-12.75 8.63-21.38 8.63-8.62 21.39-8.62 12.75 0 21.37 8.62 8.61 8.63 8.61 21.38V-490h-60ZM479.08-310Z"/></svg>
        </button>
      </div>
      <button class="tool-btn" id="btn-export" title="Export PNG" style="margin-left:auto;width:auto;gap:4px;padding:0 6px;font-size:10px;color:var(--text-dim)">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M480-480ZM202-65l-56-57 118-118h-90v-80h226v226h-80v-89L202-65Zm278-15v-80h240v-440H520v-200H240v400h-80v-400q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H480Z"/></svg>
        Export
      </button>
    </div>

    <!-- Controls -->
    <div class="controls-row">
      <div class="control-color">
        <input type="color" id="brush-color" value="#000000">
      </div>
      <div class="color-chips" id="color-chips">
        <button class="color-chip" style="background:#ffffff" data-color="#ffffff"></button>
        <button class="color-chip" style="background:#c0c0c0" data-color="#c0c0c0"></button>
        <button class="color-chip" style="background:#808080" data-color="#808080"></button>
        <button class="color-chip" style="background:#404040" data-color="#404040"></button>
        <button class="color-chip" style="background:#1a1a1a" data-color="#1a1a1a"></button>
        <button class="color-chip" style="background:#000000" data-color="#000000"></button>
        <button class="color-chip" style="background:#ffecd2" data-color="#ffecd2"></button>
        <button class="color-chip" style="background:#f8a468" data-color="#f8a468"></button>
        <button class="color-chip" style="background:#c25b3f" data-color="#c25b3f"></button>
        <button class="color-chip" style="background:#5b2c1e" data-color="#5b2c1e"></button>
        <button class="color-chip" style="background:#d4e4ff" data-color="#d4e4ff"></button>
        <button class="color-chip" style="background:#6fa0d6" data-color="#6fa0d6"></button>
        <button class="color-chip" style="background:#2d5a8e" data-color="#2d5a8e"></button>
        <button class="color-chip" style="background:#1a2744" data-color="#1a2744"></button>
      </div>
      <div class="controls-sep"></div>
      <div class="slider" data-slider="size">
        <span class="slider-label">Size</span>
        <input class="slider-track" type="range" min="0" max="1024" value="512">
        <input type="number" class="slider-val" value="512" min="0" max="1024">
      </div>
      <div class="slider" data-slider="opacity">
        <span class="slider-label">Op</span>
        <input class="slider-track" type="range" min="1" max="100" value="100">
        <input type="number" class="slider-val" value="100" min="1" max="100">
      </div>
      <div class="slider" data-slider="hardness">
        <span class="slider-label">Hard</span>
        <input class="slider-track" type="range" min="0" max="100" value="50">
        <input type="number" class="slider-val" value="50" min="0" max="100">
      </div>
    </div>

    <!-- Canvas Area -->
    <div class="canvas-area" id="canvas-area">
      <div class="canvas-wrap" id="canvas-wrap">
        <div class="canvas-bg"></div>
        <canvas id="paint-canvas" class="paint-canvas" width="1024" height="1024"></canvas>
        <div class="canvas-circle-mask"></div>
      </div>
      <canvas id="cursor-overlay" class="cursor-overlay"></canvas>
      <div class="canvas-nav">
        <button class="nav-btn" id="nav-fit" title="Fit to Screen (Ctrl+0)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M800-600v-107.69q0-4.62-3.85-8.46-3.84-3.85-8.46-3.85H680v-60h107.69Q818-780 839-759q21 21 21 51.31V-600h-60Zm-700 0v-107.69Q100-738 121-759q21-21 51.31-21H280v60H172.31q-4.62 0-8.46 3.85-3.85 3.84-3.85 8.46V-600h-60Zm580 420v-60h107.69q4.62 0 8.46-3.85 3.85-3.84 3.85-8.46V-360h60v107.69Q860-222 839-201q-21 21-51.31 21H680Zm-507.69 0Q142-180 121-201q-21-21-21-51.31V-360h60v107.69q0 4.62 3.85 8.46 3.84 3.85 8.46 3.85H280v60H172.31Zm84.61-156.92v-286.16h446.16v286.16H256.92Zm60-60h326.16v-166.16H316.92v166.16Zm0 0v-166.16 166.16Z"/></svg>
        </button>
      </div>
    </div>

  </div>

  <div class="right-panel">
    <div class="preview-area">
      <canvas id="preview-canvas" class="preview-canvas"></canvas>
      <div class="vp-controls-left">
        <select id="model-select">
          <option value="torus">Torus</option>
          <option value="torusknot">TorusKnot</option>
          <option value="amongus" selected>AmongUs</option>
        </select>
        <select id="anim-select" style="display:none"></select>
        <button class="vp-btn active" id="vp-anim" title="Toggle Animation">⏸</button>
      </div>
      <div class="vp-controls-right">
        <select id="bg-select" title="Background Color">
          <option value="#111111">Dark Gray</option>
          <option value="#000000">Black</option>
          <option value="#333333">Gray</option>
          <option value="#666666" selected>Mid Gray</option>
          <option value="#999999">Light Gray</option>
          <option value="#ffffff">White</option>
        </select>
        <button class="vp-btn active" id="vp-rotate" title="Auto Rotate">↻</button>
        <button class="vp-btn" id="vp-reset" title="Reset View">⊡</button>
      </div>
    </div>

    <!-- Layers Panel -->
    <div class="layers-panel">
      <div class="layers-header">
        <span>Layers</span>
        <div class="layers-actions">
          <button id="layer-random" title="Random Preset"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" width="16" height="16" fill="currentColor"><path d="M560-160v-80h104L537-367l57-57 126 126v-102h80v240H560Zm-344 0-57-56 504-504H560v-80h240v240h-80v-104L216-160Zm151-377L160-744l56-56 207 207-56 56Z"/></svg></button>
          <button id="layer-reset" title="Reset Layers"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" width="16" height="16" fill="currentColor"><path d="M440-122q-121-15-200.5-105.5T160-440q0-66 26-126.5T260-672l57 57q-38 34-57.5 79T240-440q0 88 56 155.5T440-202v80Zm80 0v-80q87-16 143.5-83T720-440q0-100-70-170t-170-70h-3l44 44-56 56-140-140 140-140 56 56-44 44h3q134 0 227 93t93 227q0 121-79.5 211.5T520-122Z"/></svg></button>
          <button id="layer-add" title="Add Layer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" width="16" height="16" fill="currentColor"><path d="M450-450H220v-60h230v-230h60v230h230v60H510v230h-60v-230Z"/></svg></button>
          <button id="layer-delete" title="Delete Layer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" width="16" height="16" fill="currentColor"><path d="M220-450v-60h520v60H220Z"/></svg></button>
        </div>
      </div>
      <div class="layers-body">
        <div class="layer-list" id="layer-list"></div>
        <div class="layer-settings" id="layer-settings">
          <div class="layer-settings-section">
            <div class="layer-settings-title">Adjust</div>
            <div class="detail-panel">
              <div class="hsv-row">
                <span class="hsv-label">H</span>
                <input class="hsv-slider" id="hsv-hue" type="range" min="-180" max="180" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="hsv-hue-val" value="0" min="-180" max="180">
              </div>
              <div class="hsv-row">
                <span class="hsv-label">S</span>
                <input class="hsv-slider" id="hsv-sat" type="range" min="-100" max="100" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="hsv-sat-val" value="0" min="-100" max="100">
              </div>
              <div class="hsv-row">
                <span class="hsv-label">B</span>
                <input class="hsv-slider" id="hsv-val" type="range" min="-100" max="100" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="hsv-val-val" value="0" min="-100" max="100">
              </div>
              <div class="hsv-row">
                <span class="hsv-label">C</span>
                <input class="hsv-slider" id="hsv-contrast" type="range" min="-100" max="100" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="hsv-contrast-val" value="0" min="-100" max="100">
              </div>
              <div class="hsv-row">
                <span class="hsv-label">L</span>
                <input class="hsv-slider" id="hsv-lift" type="range" min="0" max="100" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="hsv-lift-val" value="0" min="0" max="100">
              </div>
            </div>
          </div>
          <div class="layer-settings-section">
            <div class="layer-settings-title">Transform</div>
            <div class="detail-panel">
              <div class="hsv-row">
                <span class="hsv-label">X</span>
                <input class="hsv-slider" id="layer-x" type="range" min="-512" max="512" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="layer-x-val" value="0" min="-512" max="512">
              </div>
              <div class="hsv-row">
                <span class="hsv-label">Y</span>
                <input class="hsv-slider" id="layer-y" type="range" min="-512" max="512" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="layer-y-val" value="0" min="-512" max="512">
              </div>
              <div class="hsv-row">
                <span class="hsv-label">Rot</span>
                <input class="hsv-slider" id="layer-rotation" type="range" min="-180" max="180" value="0" tabindex="-1">
                <input type="number" class="hsv-val" id="layer-rotation-val" value="0" min="-180" max="180">
              </div>
              <div class="hsv-row">
                <span class="hsv-label">Sc</span>
                <input class="hsv-slider" id="layer-scale" type="range" min="10" max="300" value="100" tabindex="-1">
                <input type="number" class="hsv-val" id="layer-scale-val" value="100" min="10" max="300">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
if (!navigator.gpu) {
  document.body.innerHTML = '<div style="display:flex;align-items:center;justify-content:center;height:100vh;background:#1a1a1a;color:#ccc;font-family:system-ui;text-align:center;padding:2rem"><div><h2 style="margin-bottom:1rem">WebGPU Required</h2><p style="color:#999">This app requires WebGPU, available in Chrome/Edge 113+ and Safari 18+.<br>Firefox does not yet support WebGPU.</p></div></div>';
} else {
  const s = document.createElement('script');
  s.type = 'module';
  s.src = 'js/main.js';
  document.body.appendChild(s);
}
</script>
</body>
</html>
