<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Matcap Painter</title>
<script type="importmap">
{
  "imports": {
    "three": "/node_modules/three/build/three.core.js",
    "three/webgpu": "/node_modules/three/build/three.webgpu.js",
    "three/tsl": "/node_modules/three/build/three.tsl.js",
    "three/addons/": "/node_modules/three/examples/jsm/"
  }
}
</script>
<style>
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

:root {
  --bg: #1a1a1a;
  --panel: #232323;
  --surface: #2a2a2a;
  --border: #2f2f2f;
  --text: #d4d4d4;
  --text-dim: #777;
  --text-muted: #555;
  --accent: #5b9bd5;
  --accent-dim: #3d6d99;
  --btn: #2e2e2e;
  --btn-hover: #363636;
  --btn-active: #5b9bd5;
  --layer-hover: #2c2c2c;
  --layer-active: #2e3548;
  --track: #3a3a3a;
  --thumb: #888;
  --thumb-hover: #aaa;
}

html, body {
  height: 100%;
  background: var(--bg);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  font-size: 12px;
  overflow: hidden;
  user-select: none;
  -webkit-font-smoothing: antialiased;
}

/* --- Top Bar --- */
.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  height: 36px;
  padding: 0 12px;
  background: var(--panel);
  border-bottom: 1px solid var(--border);
}
.topbar h1 {
  font-size: 12px;
  font-weight: 500;
  color: var(--text-dim);
  letter-spacing: 0.3px;
}
.topbar-right { display: flex; align-items: center; gap: 6px; }
.topbar-right label { color: var(--text-dim); font-size: 11px; }
.topbar-right select {
  background: var(--surface);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 3px;
  padding: 3px 6px;
  font-size: 11px;
  cursor: pointer;
  outline: none;
}
.topbar-right select:focus { border-color: var(--accent-dim); }

/* --- Main Layout --- */
.main {
  display: flex;
  height: calc(100% - 36px);
}

/* --- Left Panel --- */
.left-panel {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  border-right: 1px solid var(--border);
  background: var(--panel);
}

/* Toolbar */
.toolbar {
  padding: 6px 10px;
  display: flex;
  gap: 4px;
  align-items: center;
  border-bottom: 1px solid var(--border);
}
.toolbar-group {
  display: flex;
  gap: 1px;
  align-items: center;
}
.tool-btn {
  width: 28px;
  height: 26px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: 4px;
  color: var(--text-dim);
  cursor: pointer;
  transition: all 0.12s;
}
.tool-btn:hover { background: var(--btn-hover); color: var(--text); }
.tool-btn.active {
  background: var(--accent);
  color: #fff;
  border-color: transparent;
}
.tool-btn svg { width: 15px; height: 15px; }

/* --- Slider Component --- */
.slider {
  display: flex;
  align-items: center;
  gap: 6px;
  height: 24px;
}
.slider-label {
  color: var(--text-muted);
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  min-width: 18px;
  flex-shrink: 0;
}
.slider-track {
  -webkit-appearance: none;
  appearance: none;
  width: 72px;
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  outline: none;
  cursor: pointer;
}
.slider-track::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
  transition: background 0.12s;
}
.slider-track::-webkit-slider-thumb:hover { background: var(--thumb-hover); }
.slider-track::-webkit-slider-thumb:active { background: var(--accent); }
.slider-track::-moz-range-thumb {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
}
.slider-track::-moz-range-track {
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  border: none;
}
.slider-val {
  color: var(--text-dim);
  font-size: 10px;
  font-variant-numeric: tabular-nums;
  min-width: 20px;
  text-align: right;
  flex-shrink: 0;
}

/* Controls row */
.controls-row {
  padding: 5px 10px;
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  align-items: center;
  border-bottom: 1px solid var(--border);
}
.control-color {
  display: flex;
  align-items: center;
  gap: 4px;
}
.control-color label {
  color: var(--text-muted);
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.4px;
}
.control-color input[type="color"] {
  width: 24px;
  height: 20px;
  border: 1px solid var(--border);
  border-radius: 3px;
  background: none;
  cursor: pointer;
  padding: 0;
}
.control-color input[type="color"]::-webkit-color-swatch-wrapper { padding: 1px; }
.control-color input[type="color"]::-webkit-color-swatch { border-radius: 2px; border: none; }
.controls-sep {
  width: 1px;
  height: 16px;
  background: var(--border);
}
.mirror-toggle {
  display: flex;
  align-items: center;
  gap: 4px;
  cursor: pointer;
  color: var(--text-muted);
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.4px;
}
.mirror-toggle input {
  width: 12px;
  height: 12px;
  accent-color: var(--accent);
  cursor: pointer;
}

/* Canvas area */
.canvas-area {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  position: relative;
  background: var(--bg);
}
.canvas-area.panning { cursor: grab; }
.canvas-area.panning:active { cursor: grabbing; }
.canvas-area.panning #paint-canvas { cursor: grab; }
.canvas-area.panning:active #paint-canvas { cursor: grabbing; }
.canvas-wrap {
  position: relative;
  will-change: transform;
}
.canvas-wrap > * {
  display: block;
}
.canvas-nav {
  position: absolute;
  bottom: 8px;
  right: 8px;
  display: flex;
  gap: 2px;
  background: rgba(30,30,30,0.85);
  border-radius: 5px;
  padding: 3px;
  backdrop-filter: blur(4px);
  z-index: 10;
}
.nav-btn {
  width: 26px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: 3px;
  color: var(--text-dim);
  cursor: pointer;
  transition: all 0.12s;
}
.nav-btn:hover { background: var(--btn-hover); color: var(--text); }
.nav-btn.active { background: var(--accent); color: #fff; }
.nav-btn svg { width: 14px; height: 14px; }
#zoom-badge {
  position: absolute;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.6);
  color: var(--text-dim);
  font-size: 10px;
  padding: 2px 8px;
  border-radius: 3px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
}
#zoom-badge.visible { opacity: 1; }
#paint-canvas {
  cursor: none;
  image-rendering: auto;
  position: relative;
  z-index: 1;
}
.canvas-bg {
  position: absolute;
  inset: 0;
  z-index: 0;
  border-radius: 50%;
  background: repeating-conic-gradient(#2a2a2a 0% 25%, #222 0% 50%) 50% / 16px 16px;
  pointer-events: none;
}
.canvas-circle-mask {
  position: absolute;
  inset: 0;
  z-index: 2;
  pointer-events: none;
  background: radial-gradient(circle closest-side, transparent 98%, rgba(26,26,26,0.8) 100%);
}
#cursor-overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 3;
}

/* Layers panel */
.layers-panel {
  height: 170px;
  min-height: 110px;
  border-top: 1px solid var(--border);
  display: flex;
  flex-direction: column;
}
.layers-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 5px 10px;
  border-bottom: 1px solid var(--border);
  font-size: 10px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: var(--text-dim);
}
.layers-actions { display: flex; gap: 1px; }
.layers-actions button {
  width: 24px;
  height: 22px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: none;
  border-radius: 3px;
  color: var(--text-dim);
  cursor: pointer;
  transition: all 0.12s;
}
.layers-actions button:hover { background: var(--btn-hover); color: var(--text); }
.layers-actions button svg { width: 14px; height: 14px; }
.layer-list {
  flex: 1;
  overflow-y: auto;
  padding: 2px;
}
.layer-item {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 3px 8px;
  border-radius: 3px;
  cursor: pointer;
  font-size: 11px;
  transition: background 0.1s;
}
.layer-grip {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 10px;
  flex-shrink: 0;
  cursor: grab;
  color: var(--text-muted);
  opacity: 0;
  transition: opacity 0.12s;
}
.layer-grip:active { cursor: grabbing; }
.layer-item:hover .layer-grip { opacity: 1; }
.layer-item:hover { background: var(--layer-hover); }
.layer-item.active { background: var(--layer-active); }
.layer-item.dragging { opacity: 0.35; }
.layer-item.drag-over-top { box-shadow: 0 -2px 0 var(--accent); }
.layer-item.drag-over-bottom { box-shadow: 0 2px 0 var(--accent); }
.layer-name {
  flex: 1;
  color: var(--text);
  font-size: 11px;
}
.layer-vis {
  width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  color: var(--text-dim);
  transition: opacity 0.1s;
}
.layer-vis:hover { color: var(--text); }
.layer-vis.hidden { opacity: 0.25; }
.layer-thumb {
  width: 28px;
  height: 28px;
  border-radius: 3px;
  border: 1px solid var(--border);
  flex-shrink: 0;
  image-rendering: auto;
  background: repeating-conic-gradient(#2a2a2a 0% 25%, #222 0% 50%) 50% / 6px 6px;
}
.layer-opacity {
  -webkit-appearance: none;
  appearance: none;
  width: 44px;
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  outline: none;
  cursor: pointer;
}
.layer-opacity::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
  cursor: pointer;
}
.layer-opacity::-moz-range-thumb {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: var(--thumb);
  border: none;
}
.layer-opacity::-moz-range-track {
  height: 3px;
  background: var(--track);
  border-radius: 2px;
  border: none;
}
.layer-blend {
  background: var(--surface);
  color: var(--text-dim);
  border: 1px solid transparent;
  border-radius: 3px;
  padding: 1px 4px;
  font-size: 10px;
  outline: none;
  cursor: pointer;
  flex-shrink: 0;
}
.layer-blend:focus { border-color: var(--accent-dim); }

/* --- Right Panel (3D Preview) --- */
.right-panel {
  flex: 1;
  position: relative;
  background: #111;
}
#preview-canvas {
  width: 100%;
  height: 100%;
  display: block;
}

/* Scrollbar */
::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: #3a3a3a; border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: #4a4a4a; }

/* Layer matcap button */
.layer-matcap-btn {
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border: 1px solid transparent;
  border-radius: 3px;
  color: var(--text-muted);
  cursor: pointer;
  flex-shrink: 0;
  transition: all 0.12s;
  padding: 0;
}
.layer-matcap-btn:hover { background: var(--btn-hover); color: var(--text); }

/* Matcap Picker Modal */
.matcap-picker-overlay {
  position: fixed;
  inset: 0;
  z-index: 1000;
  background: rgba(0, 0, 0, 0.5);
  backdrop-filter: blur(4px);
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.15s;
}
.matcap-picker-overlay.open {
  opacity: 1;
  pointer-events: auto;
}
.matcap-picker {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 8px;
  width: 520px;
  max-width: 90vw;
  max-height: 70vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.5);
  transform: scale(0.96);
  transition: transform 0.15s;
}
.matcap-picker-overlay.open .matcap-picker {
  transform: scale(1);
}
.matcap-picker-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 10px 14px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}
.matcap-picker-title {
  font-size: 11px;
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.4px;
  color: var(--text-dim);
}
.matcap-picker-search {
  width: 140px;
  padding: 4px 8px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 4px;
  color: var(--text);
  font-size: 11px;
  outline: none;
}
.matcap-picker-search:focus {
  border-color: var(--accent-dim);
}
.matcap-picker-search::placeholder {
  color: var(--text-muted);
}
.matcap-picker-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(56px, 1fr));
  gap: 6px;
  padding: 12px;
  overflow-y: auto;
  flex: 1;
}
.matcap-thumb {
  width: 100%;
  aspect-ratio: 1;
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid transparent;
  background: var(--surface);
  cursor: pointer;
  padding: 0;
  transition: border-color 0.12s, transform 0.12s;
}
.matcap-thumb:hover {
  border-color: var(--accent);
  transform: scale(1.08);
}
.matcap-thumb img {
  width: 100%;
  height: 100%;
  display: block;
  border-radius: 50%;
  object-fit: cover;
}
</style>
</head>
<body>

<div class="topbar">
  <h1>Matcap Painter</h1>
  <div class="topbar-right">
    <label>Model:</label>
    <select id="model-select">
      <option value="sphere" selected>Sphere</option>
      <option value="torus">Torus</option>
      <option value="torusknot">TorusKnot</option>
      <option value="box">Box</option>
      <option value="suzanne">Suzanne</option>
    </select>
    <button class="tool-btn" id="btn-export" title="Export PNG">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M450-780v485.08L222.15-522.77 180-480l300 300 300-300-42.15-42.77L510-294.92V-780h-60Z"/></svg>
    </button>
    <button class="tool-btn" id="btn-import" title="Import matcap">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M450-328.46v-336l-98.61 98.61-42.16-43.38L480-780l170.77 170.77-42.16 43.38L510-664.46v336h-60ZM252.31-180Q222-180 201-201q-21-21-21-51.31v-108.46h60v108.46q0 4.62 3.85 8.46 3.84 3.85 8.46 3.85h455.38q4.62 0 8.46-3.85 3.85-3.84 3.85-8.46v-108.46h60v108.46Q780-222 759-201q-21 21-51.31 21H252.31Z"/></svg>
    </button>
    <input type="file" id="file-import" accept="image/*" style="display:none">
  </div>
</div>

<div class="main">
  <div class="left-panel">
    <!-- Toolbar -->
    <div class="toolbar">
      <div class="toolbar-group">
        <button class="tool-btn active" data-tool="brush" title="Brush (B)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M247.69-147.69q-34.33 0-67.89-15.08-33.57-15.08-55.95-40.31 22.92-6.54 43.38-27.81 20.46-21.26 20.46-56.8 0-41.93 29.04-70.96 29.04-29.04 70.96-29.04 41.93 0 70.96 29.04 29.04 29.03 29.04 70.96 0 57.75-41.12 98.87-41.13 41.13-98.88 41.13Zm0-60q33 0 56.5-23.5t23.5-56.5q0-17-11.5-28.5t-28.5-11.5q-17 0-28.5 11.5t-11.5 28.5q0 23-5.5 42t-14.5 36q5 2 10 2h10ZM460-370l-89.23-89.23 342.61-342.61q11-11 27.5-11.5t28.5 11.5l33.23 33.23q12 12 12 28t-12 28L460-370Zm-172.31 82.31Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="airbrush" title="Airbrush (A)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M460-174.62q-43.08 0-74.04-29.03-30.96-29.04-34.42-70.96h60.77q3.07 17.38 16.31 28.69 13.23 11.31 31.38 11.31 20.85 0 35.42-14.58Q510-263.77 510-284.62q0-20.84-14.58-35.42-14.57-14.58-35.42-14.58H90v-59.99h370q45.77 0 77.88 32.11Q570-330.38 570-284.62q0 45.77-32.12 77.89-32.11 32.11-77.88 32.11ZM90-565.39v-59.99h530q29.85 0 49.92-20.08Q690-665.54 690-695.38q0-29.85-20.08-49.93-20.07-20.08-49.92-20.08-27.54 0-46.46 17-18.93 17-22 43h-60.77q3.46-51.3 40.31-85.65 36.84-34.34 88.92-34.34 54.77 0 92.38 37.61Q750-750.15 750-695.38q0 54.76-37.62 92.38-37.61 37.61-92.38 37.61H90Zm660 314.62v-60.77q26-3.07 43-22 17-18.92 17-46.46 0-29.85-20.08-49.92Q769.85-450 740-450H90v-60h650q54.77 0 92.38 37.62Q870-434.77 870-380q0 52.08-34.35 88.92-34.34 36.85-85.65 40.31Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="blur" title="Blur (R)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M426.38-533.62q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54Zm0 160q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54ZM294-546q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm106 286q8 0 14-6t6-14q0-8-6-14t-14-6q-8 0-14 6t-6 14q0 8 6 14t14 6ZM294-386q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm120-280q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm172.38 132.38q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54ZM574-666q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm120 280q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm0-160q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6ZM331.86-129.92q-69.37-29.92-120.68-81.21-51.31-51.29-81.25-120.63Q100-401.1 100-479.93q0-78.84 29.92-148.21t81.21-120.68q51.29-51.31 120.63-81.25Q401.1-860 479.93-860q78.84 0 148.21 29.92t120.68 81.21q51.31 51.29 81.25 120.63Q860-558.9 860-480.07q0 78.84-29.92 148.21t-81.21 120.68q-51.29 51.31-120.63 81.25Q558.9-100 480.07-100q-78.84 0-148.21-29.92ZM480-160q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm94-106q6-6 6-14t-6-14q-6-6-14-6t-14 6q-6 6-6 14t6 14q6 6 14 6t14-6Zm12.38-107.62q10.54-10.53 10.54-26.38t-10.54-26.38q-10.53-10.54-26.38-10.54t-26.38 10.54q-10.54 10.53-10.54 26.38t10.54 26.38q10.53 10.54 26.38 10.54t26.38-10.54ZM480-480Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="eraser" title="Eraser (E)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M679.23-240h188.46v60H619.23l60-60Zm-493.08 60-70.76-70.77Q94.31-271.85 93.81-302t20.58-52.23l423.07-439.08q21.08-22.07 50.92-21.88 29.85.19 50.93 21.27l181.3 181.31q21.08 21.07 21.27 51.42.19 30.34-20.88 51.42L499.23-180H186.15Zm287.54-60 305.15-313.15q3.08-3.08 3.08-8.85t-3.08-8.85L598.15-751.54q-3.07-3.07-8.65-3.07t-8.66 3.46l-424.3 438.3q-3.08 3.46-3.08 9.04 0 5.58 3.08 8.66L211.69-240h262ZM480-480Z"/></svg>
        </button>
        <button class="tool-btn" data-tool="fill" title="Fill (G)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M346.77-159.23 119.23-386.77q-9.61-9.66-14.42-21.25-4.81-11.6-4.81-24.1 0-12.5 4.81-24.03 4.81-11.54 14.42-21.16l226.16-225.54-110.62-109.07 46.61-48.46L664.5-476.89q9.58 9.58 14.08 21.14t4.5 24.09q0 12.52-4.5 24.08-4.5 11.56-14.12 21.2L437.31-159.23q-9.62 9.61-21.16 14.42-11.53 4.81-24.03 4.81-12.5 0-24.1-4.81-11.59-4.81-21.25-14.42Zm45.08-497.16L175.54-440.08q-2.31 2.31-3.08 4.62t-.77 4.61H612q0-2.3-.77-4.61-.77-2.31-3.08-4.62l-216.3-216.31ZM782.38-140q-32.15 0-54.07-22.6-21.93-22.61-21.93-55.4 0-24.31 11.39-46.39 11.38-22.07 27.23-42.38l37.38-47.08 39.39 47.08q15.23 20.31 26.92 42.38 11.69 22.08 11.69 46.39 0 32.79-22.92 55.4-22.92 22.6-55.08 22.6Z"/></svg>
        </button>
        <button class="tool-btn" id="tool-pan" title="Pan (H)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M419.31-70q-27.47 0-51.27-12.35-23.81-12.34-39.65-35.42l-250-366.08 16.3-15.69q15.93-15.92 37.7-17.96 21.76-2.04 39.69 10.65L300-417.77v-361.07q0-12.75 8.63-21.38 8.63-8.62 21.38-8.62 12.76 0 21.37 8.62 8.62 8.63 8.62 21.38v476.61L197.77-415.85l180.08 263.62q6.54 10.31 17.65 16.27 11.12 5.96 23.81 5.96H670q37.61 0 63.81-26.19Q760-182.39 760-220v-530q0-12.75 8.63-21.37 8.63-8.63 21.38-8.63 12.76 0 21.37 8.63Q820-762.75 820-750v530q0 62.15-43.92 106.07Q732.15-70 670-70H419.31Zm34.15-420v-368.84q0-12.75 8.63-21.38 8.63-8.62 21.39-8.62 12.75 0 21.37 8.62 8.61 8.63 8.61 21.38V-490h-60Zm153.46 0v-328.84q0-12.75 8.63-21.38 8.63-8.62 21.39-8.62 12.75 0 21.37 8.62 8.61 8.63 8.61 21.38V-490h-60ZM479.08-310Z"/></svg>
        </button>
      </div>
    </div>

    <!-- Controls -->
    <div class="controls-row">
      <div class="control-color">
        <input type="color" id="brush-color" value="#c0c0c0">
      </div>
      <div class="controls-sep"></div>
      <div class="slider" data-slider="size">
        <span class="slider-label">Size</span>
        <input class="slider-track" type="range" min="1" max="100" value="20">
        <span class="slider-val">20</span>
      </div>
      <div class="slider" data-slider="opacity">
        <span class="slider-label">Op</span>
        <input class="slider-track" type="range" min="1" max="100" value="100">
        <span class="slider-val">100</span>
      </div>
      <div class="slider" data-slider="hardness">
        <span class="slider-label">Hard</span>
        <input class="slider-track" type="range" min="0" max="100" value="50">
        <span class="slider-val">50</span>
      </div>
      <div class="controls-sep"></div>
      <label class="mirror-toggle">
        <input type="checkbox" id="mirror-x"> X
      </label>
      <label class="mirror-toggle">
        <input type="checkbox" id="mirror-y"> Y
      </label>
    </div>

    <!-- Canvas Area -->
    <div class="canvas-area" id="canvas-area">
      <div class="canvas-wrap" id="canvas-wrap">
        <div class="canvas-bg"></div>
        <canvas id="paint-canvas" width="512" height="512"></canvas>
        <div class="canvas-circle-mask"></div>
        <canvas id="cursor-overlay" width="512" height="512"></canvas>
      </div>
      <div class="canvas-nav">
        <button class="nav-btn" id="nav-zoom-in" title="Zoom In">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M781.69-136.92 530.46-388.16q-30 24.77-69 38.77-39 14-80.69 14-102.55 0-173.58-71.01-71.03-71.01-71.03-173.54 0-102.52 71.01-173.6 71.01-71.07 173.54-71.07 102.52 0 173.6 71.03 71.07 71.03 71.07 173.58 0 42.85-14.38 81.85-14.39 39-38.39 67.84l251.23 251.23-42.15 42.16ZM380.77-395.38q77.31 0 130.96-53.66 53.66-53.65 53.66-130.96t-53.66-130.96q-53.65-53.66-130.96-53.66t-130.96 53.66Q196.15-657.31 196.15-580t53.66 130.96q53.65 53.66 130.96 53.66Zm-30-76.93V-550h-77.69v-60h77.69v-77.69h60V-610h77.69v60h-77.69v77.69h-60Z"/></svg>
        </button>
        <button class="nav-btn" id="nav-zoom-out" title="Zoom Out">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M781.69-136.92 530.46-388.16q-30 24.77-69 38.77-39 14-80.69 14-102.46 0-173.54-71.07-71.07-71.08-71.07-173.54t71.07-173.54q71.08-71.07 173.54-71.07t173.54 71.07q71.07 71.08 71.07 173.54 0 42.85-14.38 81.85-14.39 39-38.39 67.84l251.23 251.23-42.15 42.16ZM380.77-395.38q77.31 0 130.96-53.66 53.66-53.65 53.66-130.96t-53.66-130.96q-53.65-53.66-130.96-53.66t-130.96 53.66Q196.15-657.31 196.15-580t53.66 130.96q53.65 53.66 130.96 53.66ZM285.39-550v-60h190.76v60H285.39Z"/></svg>
        </button>
        <button class="nav-btn" id="nav-fit" title="Fit to Screen (Ctrl+0)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M800-600v-107.69q0-4.62-3.85-8.46-3.84-3.85-8.46-3.85H680v-60h107.69Q818-780 839-759q21 21 21 51.31V-600h-60Zm-700 0v-107.69Q100-738 121-759q21-21 51.31-21H280v60H172.31q-4.62 0-8.46 3.85-3.85 3.84-3.85 8.46V-600h-60Zm580 420v-60h107.69q4.62 0 8.46-3.85 3.85-3.84 3.85-8.46V-360h60v107.69Q860-222 839-201q-21 21-51.31 21H680Zm-507.69 0Q142-180 121-201q-21-21-21-51.31V-360h60v107.69q0 4.62 3.85 8.46 3.84 3.85 8.46 3.85H280v60H172.31Zm84.61-156.92v-286.16h446.16v286.16H256.92Zm60-60h326.16v-166.16H316.92v166.16Zm0 0v-166.16 166.16Z"/></svg>
        </button>
        <button class="nav-btn" id="nav-pan" title="Pan (Space)">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" fill="currentColor"><path d="M419.31-70q-27.47 0-51.27-12.35-23.81-12.34-39.65-35.42l-250-366.08 16.3-15.69q15.93-15.92 37.7-17.96 21.76-2.04 39.69 10.65L300-417.77v-361.07q0-12.75 8.63-21.38 8.63-8.62 21.38-8.62 12.76 0 21.37 8.62 8.62 8.63 8.62 21.38v476.61L197.77-415.85l180.08 263.62q6.54 10.31 17.65 16.27 11.12 5.96 23.81 5.96H670q37.61 0 63.81-26.19Q760-182.39 760-220v-530q0-12.75 8.63-21.37 8.63-8.63 21.38-8.63 12.76 0 21.37 8.63Q820-762.75 820-750v530q0 62.15-43.92 106.07Q732.15-70 670-70H419.31Zm34.15-420v-368.84q0-12.75 8.63-21.38 8.63-8.62 21.39-8.62 12.75 0 21.37 8.62 8.61 8.63 8.61 21.38V-490h-60Zm153.46 0v-328.84q0-12.75 8.63-21.38 8.63-8.62 21.39-8.62 12.75 0 21.37 8.62 8.61 8.63 8.61 21.38V-490h-60ZM479.08-310Z"/></svg>
        </button>
      </div>
    </div>

    <!-- Layers Panel -->
    <div class="layers-panel">
      <div class="layers-header">
        <span>Layers</span>
        <div class="layers-actions">
          <button id="layer-add" title="Add Layer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" width="16" height="16" fill="currentColor"><path d="M450-450H220v-60h230v-230h60v230h230v60H510v230h-60v-230Z"/></svg></button>
          <button id="layer-delete" title="Delete Layer"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960" width="16" height="16" fill="currentColor"><path d="M220-450v-60h520v60H220Z"/></svg></button>
        </div>
      </div>
      <div class="layer-list" id="layer-list"></div>
    </div>
  </div>

  <div class="right-panel">
    <canvas id="preview-canvas"></canvas>
  </div>
</div>

<script type="module" src="js/main.js"></script>
</body>
</html>
